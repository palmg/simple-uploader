/* r-simple-uploader v3.0.0 | (c) Mycolorway Design | MIT License */
!function(e,t){"object"==typeof module&&module.exports?module.exports=t(require("jquery"),require("simple-module")):e.SimpleUploader=t(e.jQuery,e.SimpleModule)}(this,function(e,t){return(require=function e(t,r,o){function n(u,l){if(!r[u]){if(!t[u]){var s="function"==typeof require&&require;if(!l&&s)return s(u,!0);if(i)return i(u,!0);var a=new Error("Cannot find module '"+u+"'");throw a.code="MODULE_NOT_FOUND",a}var p=r[u]={exports:{}};t[u][0].call(p.exports,function(e){var r=t[u][1][e];return n(r||e)},p,p.exports,e,t,r,o)}return r[u].exports}for(var i="function"==typeof require&&require,u=0;u<o.length;u++)n(o[u]);return n}({"simple-uploader":[function(r,o,n){var i,u=function(e,t){function r(){this.constructor=e}for(var o in t)l.call(t,o)&&(e[o]=t[o]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},l={}.hasOwnProperty;i=function(t){function r(t){r.__super__.constructor.apply(this,arguments),this.opts=e.extend({},r.opts,t),this._locales=e.extend({},r.locales,this.opts.locales),this.files=[],this.queue=[],this.uploading=!1,this.id=++r.count,t.fileUpload&&"function"==typeof t.fileUpload&&(r.prototype._xhrUpload=t.fileUpload),this._bind()}return u(r,t),r.count=0,r.opts={url:"",params:null,fileKey:"upload_file",connectionCount:3,locales:null},r.locales={leaveConfirm:"Are you sure you want to leave?"},r.prototype._bind=function(){return this.on("uploadcomplete",function(t){return function(r,o){return t.files.splice(e.inArray(o,t.files),1),t.queue.length>0&&t.files.length<t.opts.connectionCount?t.upload(t.queue.shift()):0===t.files.length?t.uploading=!1:void 0}}(this)),e(window).on("beforeunload.uploader-"+this.id,function(e){return function(t){if(e.uploading)return t.originalEvent.returnValue=e._locales.leaveConfirm,e._locales.leaveConfirm}}(this))},r.prototype.generateId=function(){var e;return e=0,function(){return e+=1}}(),r.prototype.upload=function(t,r){var o,n,i,u;if(null==r&&(r={}),null!=t){if(e.isArray(t)||t instanceof FileList)for(n=0,u=t.length;n<u;n++)o=t[n],this.upload(o,r);else e(t).is("input:file")?(i=e(t).attr("name"),i&&(r.fileKey=i),this.upload(e.makeArray(e(t)[0].files),r)):t.id&&t.obj||(t=this.getFile(t));if(t&&t.obj){if(e.extend(t,r),this.files.length>=this.opts.connectionCount)return void this.queue.push(t);if(!1!==this.trigger("beforeupload",[t]))return this.files.push(t),this._xhrUpload(t,this,e),this.uploading=!0}}},r.prototype.getFile=function(e){var t,r,o;return e instanceof window.File||e instanceof window.Blob?(t=null!=(r=e.fileName)?r:e.name,{id:this.generateId(),url:this.opts.url,params:this.opts.params,fileKey:this.opts.fileKey,name:t,size:null!=(o=e.fileSize)?o:e.size,ext:t?t.split(".").pop().toLowerCase():"",obj:e}):null},r.prototype._xhrUpload=function(t,r,o){var n,i,u,l,s;if("function"==typeof(i=this.opts.formData))n=i(t,r,o);else if("object"==typeof i&&i.generate)n=i.generate(t,r,o);else if(n=new FormData,n.append(t.fileKey,t.obj),n.append("original_filename",t.name),t.params){l=t.params;for(u in l)s=l[u],n.append(u,s)}return t.xhr=e.ajax({url:t.url,data:n,processData:!1,contentType:!1,type:"POST",headers:{"X-File-Name":encodeURIComponent(t.name)},xhr:function(){var t;return t=e.ajaxSettings.xhr(),t&&(t.upload.onprogress=function(e){return function(t){return e.progress(t)}}(this)),t},progress:function(e){return function(r){if(r.lengthComputable)return e.trigger("uploadprogress",[t,r.loaded,r.total])}}(this),error:function(e){return function(r,o,n){return e.trigger("uploaderror",[t,r,o])}}(this),success:function(r){return function(o){return r.trigger("uploadprogress",[t,t.size,t.size]),r.trigger("uploadsuccess",[t,o]),e(document).trigger("uploadsuccess",[t,o,r])}}(this),complete:function(e){return function(r,o){return e.trigger("uploadcomplete",[t,r.responseText])}}(this)})},r.prototype.cancel=function(t){var r,o,n,i;if(!t.id)for(i=this.files,o=0,n=i.length;o<n;o++)if(r=i[o],r.id===1*t){t=r;break}return this.files.splice(e.inArray(t,this.files),1),this.trigger("uploadcancel",[t]),t.xhr&&t.xhr.abort(),t.xhr=null},r.prototype.readImageFile=function(t,r){var o,n;if(e.isFunction(r))return n=new Image,n.onload=function(){return r(n)},n.onerror=function(){return r(!1)},window.FileReader&&FileReader.prototype.readAsDataURL&&/^image/.test(t.type)?(o=new FileReader,o.onload=function(e){return n.src=e.target.result},o.readAsDataURL(t)):r(!1)},r.prototype.destroy=function(){var t,r,o,n;for(this.queue.length=0,n=this.files,r=0,o=n.length;r<o;r++)t=n[r],this.cancel(t);return e(window).off(".uploader-"+this.id),e(document).off(".uploader-"+this.id)},r}(t),o.exports=i},{}]},{},[]))("simple-uploader")});